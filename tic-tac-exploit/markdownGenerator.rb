
class MarkdownGenerator
    IMAGE_BASE_URL = 'https://raw.githubusercontent.com/Summeli/tic-tac-exploit/master/img'
    ISSUE_BASE_URL = 'https://github.com/Summeli/tic-tac-exploit/issues/new'
    ISSUE_BODY = 'body=Just+push+%27Submit+new+issue%27+without+editing+the+title.+The+README+will+be+updated+after+approximately+30+seconds.'

    EMPTY = "#{IMAGE_BASE_URL}/empty.png"
    O = "#{IMAGE_BASE_URL}/o.png"
    X = "#{IMAGE_BASE_URL}/x.png"
    BG = "#{IMAGE_BASE_URL}/bg.png"
    RESET_URL = "#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C0%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"

    def initialize
    end

    def renderReadme(game_state:, githubuser: 'keijo', winner: false )
        markdown = <<~HTML
        #do you have what it takes to hack us? Click anywhere to find out
        <table background=#{BG}>
        <tr>
        HTML
        
        #first row
        markdown.concat << renderEndGameCell(cell: game_state[0])
        markdown.concat << renderEndGameCell(cell: game_state[1])
        markdown.concat << renderEndGameCell(cell: game_state[2])
        markdown.concat << "</tr> <tr>"
        #second row
        markdown.concat << renderEndGameCell(cell: game_state[3])
        markdown.concat << renderEndGameCell(cell: game_state[4])
        markdown.concat << renderEndGameCell(cell: game_state[5])
        markdown.concat << "</tr> <tr>"
        #third row
        markdown.concat << renderEndGameCell(cell: game_state[6])
        markdown.concat << renderEndGameCell(cell: game_state[7])
        markdown.concat << renderEndGameCell(cell: game_state[8])
        markdown.concat << "</tr></table>"
        return markdown;
    end

    def renderReset()
        markdown = <<~HTML
        ###Tic-Tac-Exploit

        do you have what it takes to hack us? 
        
        <table background=#{BG}>
          <tr>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A1%7C0%7C0%7C0%7C0%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="1" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C1%7C0%7C0%7C0%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="2" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C1%7C0%7C0%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="3" width = 128px height = 128px ></a></td>
           </tr> 
           <tr>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C1%7C0%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="4" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C1%7C0%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="5" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C0%7C1%7C0%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="6" width = 128px height = 128px ></a></td>
          </tr>
          <tr>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C0%7C0%7C1%7C0%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}"  alt="7" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C0%7C0%7C0%7C1%7C0&#{ISSUE_BODY}"><img src="#{EMPTY}" alt="8" width = 128px height = 128px ></a></td>
            <td> <a href="#{ISSUE_BASE_URL}?title=ttestate%3A0%7C0%7C0%7C0%7C0%7C0%7C0%7C0%7C1&#{ISSUE_BODY}"><img src="#{EMPTY}" alt="9" width = 128px height = 128px ></a></td>
          </tr>
        </table>
        HTML
        return markdown
    end

  private

    def renderEndGameCell(cell:)
      if(cell == '0')
        return "<td><a href=#{RESET_URL}><img src=#{X}></a>"
      else
        return "<td><a href=#{RESET_URL}><img src=#{O}></a>"
      end
    end

end
